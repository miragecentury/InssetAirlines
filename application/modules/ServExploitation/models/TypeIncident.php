<?php

class ServExploitation_Model_TypeIncident {

    //--------------------------------------------------------------------------
    //Attributs
    //--------------------------------------------------------------------------
    /**
     * label du type incident
     * @var string
     */
    protected $_labelTypeIncident;

    /**
     * Mapper de l'objet
     * @var ServExploitation_Model_TypeIncidentMapper
     */
    private $_mapper;

    /**
     * Constructeur
     * @return void
     * @author charles
     */
    public function __construct() {
        $this->_mapper = Spesx_Mapper_MapperFactory::getMapper("ServExploitation_Model_TypeIncident");
    }

    //--------------------------------------------------------------------------
    // Methodes
    //--------------------------------------------------------------------------

    /**
     * Ajoute un type d'incident.
     *
     * @author charles
     * @access public
     *
     */
    public function addTypeIncident() {
        $this->_mapper->saveByLabel($this, 'labelTypeIncident');
    }

    /**
     * Suprime un labelTypeIncident.
     *
     * @author charles
     * @access public
     * @param string $labelTypeIncident
     *
     */
    public function delTypeIncident($labelTypeIncident) {
        try {
            $this->_mapper->delete('labelTypeIncident', $labelTypeIncident);
        } catch (Zend_Exception $e) {
            echo 'ServExploitation_Models_TypeIncident_delTypeIncident() 
                Exception - ' .
            $e->getMessage() . ' - ' . $e->getPrevious();
        }
    }

    /**
     * Retourne un Type d'incident a partir de son labelTypeIncident.
     * S'il n'existe pas, retourne null.
     * 
     * @access public
     * @author charles
     * @param string $labelTypeIncident
     * @return null|ServExploitation_Model_TypeIncident
     *  
     */
    public function getTypeIncident($labelTypeIncident) {
        return $this->_mapper->find($labelTypeIncident);
    }

    /**
     * Retourne un TypeIncident sous forme de tableau HTML
     * 
     * @access public
     * @author charles
     * @return string
     *  
     */
    public function getTypeIncidentHTML() {
        $Incident = "<div>Label Incident : " . $this->get_labelTypeIncident() . "</div>";
        return $Incident;
    }

    /**
     * Retourne tout les types d'incidents, 
     * null si il n'y en as pas dans la BD
     * 
     * @access public
     * @author charles
     * @return null|array(Application_Model_TypeIncident)
     *  
     */
    public static function getListeTypeIncident() {
        $mapper = Spesx_Mapper_MapperFactory::getMapper("ServExploitation_Model_TypeIncident");
        try {
            return $mapper->findAll();
        } catch (Spesx_Mapper_Exception $e) {
            echo $e->getMessage() . " - " . $e->getPrevious()->getMessage();
        }
        return $return;
    }

    /**
     * Retourne tous les incidents sous forme de tableau html, 
     * retourne une phrase disant qu'il n'y en a pas dans la bd si c'est le cas
     * 
     * @access public
     * @author charles
     * @return string
     *  
     */
    public static function getListeTypeIncidentHTML() {
        $allTypeIncident = ServExploitation_Model_TypeIncident::getListeTypeIncident();


        if (!empty($allTypeIncident)) {
            $tableau = "<table>
                        <tr>
                            <td>Label Type Incident</td>
                            <td></td>
                        </tr>";

            foreach ($allTypeIncident as $val) {
                $tableau .= "<tr>
                                <td>" . $val->get_labelTypeIncident() . "</td>
                                <td><a href='/ServExploitation/Typeincident/deltypeincident?id=" . $val->get_labelTypeIncident() . "'>Supprimer</a></td>
                            </tr>";
            }
            $tableau .= "</table>";
        } else {
            $tableau = "<div>Il n'y a pas de Type d'incident dans la base de donn√©e</div>";
        }
        return $tableau;
    }

    /**
     * Retourne tous les type d'incident sous forme de select,
     * retourne un select vide s'il n'y en a pas
     * 
     * @access public
     * @author charles
     * @param string $name, string $label
     * @return Zend_Form_Element_Select
     *  
     */
    public static function getSelectTypeIncident($name, $label) {
        try {
            $TypeIncidents = ServExploitation_Model_TypeIncident::getListeTypeIncident();
            $labelTypeIncident = new Zend_Form_Element_Select($name);
            foreach ($TypeIncidents as $TypeIncident) {
                $labelTypeIncident->addMultiOption($TypeIncident->get_labelTypeIncident(), $TypeIncident->get_labelTypeIncident());
            }
            $labelTypeIncident->setRequired();
            $labelTypeIncident->setLabel($label);
            return $labelTypeIncident;
        } catch (Spesx_Mapper_Exception $e) {
            echo $e->getMessage() . " - " . $e->getPrevious()->getMessage();
        }
    }

    //--------------------------------------------------------------------------
    // Getter / setter
    //--------------------------------------------------------------------------
    public function get_labelTypeIncident() {
        return $this->_labelTypeIncident;
    }

    public function set_labelTypeIncident($_labelTypeIncident) {
        $this->_labelTypeIncident = $_labelTypeIncident;
        return $this;
    }

}

?>
